var RevealNotes=function(){var l=null;function e(e){if(!l||l.closed){if(!e){var t=document.querySelector('script[src$="notes.js"]').src;e=(t=t.replace(/notes\.js(\?.*)?$/,""))+"notes.html"}var o;if(l=window.open(e,"reveal.js - Notes","width=1100,height=700"))o=setInterval(function(){l.postMessage(JSON.stringify({namespace:"reveal-notes",type:"connect",url:window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,state:Reveal.getState()}),"*")},500),window.addEventListener("message",function(e){var t,a,n,s,r=JSON.parse(e.data);r&&"reveal-notes"===r.namespace&&"connected"===r.type&&(clearInterval(o),Reveal.addEventListener("slidechanged",i),Reveal.addEventListener("fragmentshown",i),Reveal.addEventListener("fragmenthidden",i),Reveal.addEventListener("overviewhidden",i),Reveal.addEventListener("overviewshown",i),Reveal.addEventListener("paused",i),Reveal.addEventListener("resumed",i),i()),r&&"reveal-notes"===r.namespace&&"call"===r.type&&(t=r.methodName,a=r.arguments,n=r.callId,s=Reveal[t].apply(Reveal,a),l.postMessage(JSON.stringify({namespace:"reveal-notes",type:"return",result:s,callId:n}),"*"))});else alert("Speaker view popup failed to open. Please make sure popups are allowed and reopen the speaker view.")}else l.focus();function i(e){var t=Reveal.getCurrentSlide(),a=t.querySelector("aside.notes"),n=t.querySelector(".current-fragment"),s={namespace:"reveal-notes",type:"state",notes:"",markdown:!1,whitespace:"normal",state:Reveal.getState()};if(t.hasAttribute("data-notes")&&(s.notes=t.getAttribute("data-notes"),s.whitespace="pre-wrap"),n){var r=n.querySelector("aside.notes");r?a=r:n.hasAttribute("data-notes")&&(s.notes=n.getAttribute("data-notes"),s.whitespace="pre-wrap",a=null)}a&&(s.notes=a.innerHTML,s.markdown="string"==typeof a.getAttribute("data-markdown")),l.postMessage(JSON.stringify(s),"*")}}return{init:function(){/receiver/i.test(window.location.search)||(null!==window.location.search.match(/(\?|\&)notes/gi)&&e(),Reveal.addKeyBinding({keyCode:83,key:"S",description:"Speaker notes view"},function(){e()}))},open:e}}();Reveal.registerPlugin("notes",RevealNotes);